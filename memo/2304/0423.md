# token decimal 가져오기

아니 decimal이 erc20 간에도 일관성이 없네..

생각도 못했다.. usdt, usdc는 6인데 dai는 18이고..

아마 decimal을 함께 요청하는게 좋을 것 같다..

내 기억에 erc20 컨트랙트에 decimal 가져오는 함수도 있었으니까

아마 abi에 추가해서 decimal도 함께 받아올 수 있을 것 같음.

done.

# main coin 정보 가져오기

메인넷은 이더리움이고, 메인넷의 l2 솔루션인 op, arb도 메인 토큰은 이더리움임.

폴리곤만 매틱.

근데 폴리곤도 l2 아니었나? 왜 얘만 매틱이지?

아발란체, 솔라나는 l1이므로 자체 토큰이 메인이지만

지금 ethers가 아직 아발란체는 지원안해주는 듯.

솔라나는 아예 구조가 이더리움이랑 달라서 예외고..

done

# 실시간 가스비

이것도 ethers로 해결가능하다.

getGasPrice라는 직관적 그 자체인 메서드를 쓰면 됨.

오히려 이걸 어디 모듈에 추가할지 고르는게 어려울 듯.

//

음.. 이건 웹소켓을 사용하고 싶음.

원래는 setTimeout을 사용하려고 했는데

ethers > alchemy provider로 웹소켓 통신용 인스턴스를 만들고,

실시간 gas fee를 웹소켓으로 업데이트해주는게 좋을 것 같다.

성능적인 면은 둘째치고 웹소켓 사용을 좀 익혀야 할 것 같음.

이건 또 공사가 많이 필요할 것 같고,

실시간 가격 반영하는것 부터 해보자.

# 실시간 토큰 가격을 반영

이건 api를 사용해야 할 것 같음.

코인켓코, 코인마켓캡이 있는데,

전자가 분당 50개까지 허용, 후자는 달에 만개, 분당 30개라 전자가 약간 더 좋은 것 같음.

api 사용도 좀 더 직관적이고 정보도 많이 주는 듯. 하도 많아서 보기가 힘들 정도임.

다른 네트워크에서 이 토큰의 ca도 주고..

심지어 별도 api key도 필요가 없는 듯.

이렇게 좋아도 되냐? 코인겟코 당신은 대체..

단점이라면 너무 정보가 많아서 시간이 좀 더 걸릴수도 있겠다 정도

https://api.coingecko.com/api/v3/coins/{chain}/contract/{contract_address}

e.g.

curl https://api.coingecko.com/api/v3/coins/ethereum/contract/0xAf5191B0De278C7286d6C7CC6ab6BB8A73bA2Cd6

chain, ca 만 정해주면 되서 기존 로직에서 크게 변경할 필요도 없다.

네이티브 토큰과 다른 토큰은 api가 좀 다르다.

이제 프론트에서 요청 보내고 받아오면 된다.

//

오늘은 여기까지. 별 것도 안했는데 시간이 왜케 빨리 간 것 같지..
